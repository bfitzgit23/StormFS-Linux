# Depends on: cmake abseil-cpp

name=protobuf
version=27.2
release=1
source=(https://github.com/protocolbuffers/${name}/releases/download/v${version}/${name}-${version}.tar.gz)
pkg_build () {
mkdir build &&
cd    build &&

cmake -DCMAKE_INSTALL_PREFIX=/usr      \
      -DCMAKE_BUILD_TYPE=Release       \
      -DCMAKE_SKIP_INSTALL_RPATH=ON    \
      -Dprotobuf_BUILD_TESTS=OFF       \
      -Dprotobuf_ABSL_PROVIDER=package \
      -Dprotobuf_BUILD_LIBUPB=OFF      \
      -Dprotobuf_BUILD_SHARED_LIBS=ON  \
      -Dutf8_range_ENABLE_INSTALL=OFF  \
      -G Ninja ..                      &&
ninja
sed 's/utf8_range//' -i *.pc &&
ninja install
}
